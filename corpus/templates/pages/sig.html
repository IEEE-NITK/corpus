{% extends 'base.html' %}
{% load static %}

{% block title %}
{{ sig.name }}
{% endblock %}

{% block style %}
<link rel="stylesheet" href="{% static 'css/index.css' %}" />
{% endblock %}

{% block content %}

<div class="bg-base-200">
  <section
    class="hero min-h-[50vh] min-w-screen bg-gradient-to-br from-sky-50 to-blue-300 dark:from-blue-950 dark:to-base-100">
    <div id="particles-js" class="h-[50vh] w-full"></div>
    <div class="flex flex-col lg:flex-row gap-20 justify-between mx-auto items-center">
      <h1
        class="relative text-4xl sm:text-6xl md:text-7xl lg:text-9xl font-extrabold mb-6  dark:text-white drop-shadow-[0_0_35px_rgba(255,255,255,0.5)]">
        {{ sig.name }}
      </h1>
    </div>
  </section>


  <section class="py-20 px-6 dark:bg-gray-900 align-middle">
    <div class="max-w-6xl mx-auto flex flex-col lg:flex-row items-center justify-center lg:items-start gap-16">

      <div class="flex-1 text-center">
        <h2 class="text-4xl font-bold mb-6 dark:text-white">About {{ sig.name }}</h2>
        <p class="dark:text-gray-300 text-base sm:text-lg leading-relaxed mb-8 text-justify">

          {{ sig.about|linebreaksbr|safe }}
        </p>

        <h2 class="text-3xl font-bold mb-6 dark:text-white">What We Do</h2>
        <p class="dark:text-gray-300 text-base sm:text-lg leading-relaxed mb-8 text-justify">

          {{ sig.what_we_do|linebreaksbr|safe }}
        </p>
      </div>

      <div class="flex-1 my-auto ">
        <div
          class="w-full max-w-sm mx-auto bg-gradient-to-br from-sky-50 to-blue-300 dark:from-blue-950 dark:to-base-100 rounded-2xl shadow-xl p-10 flex flex-col items-center text-center transform transition-all duration-300 hover:scale-105 hover:shadow-2xl">
          <div class="text-4xl sm:text-5xl lg:text-6xl font-extrabold dark:text-white mb-3">{{ no_of_members }}</div>
          <div class="text-lg sm:text-xl dark:text-gray-100 mb-8">Active Members</div>
          <div class="text-2xl sm:text-3xl lg:text-4xl font-extrabold dark:text-white mb-3">{{ no_of_events }}</div>
          <div class="text-lg sm:text-xl dark:text-gray-100">Events This Year</div>

        </div>
      </div>

    </div>
  </section>



  <section
    class="py-10 bg-gradient-to-br from-sky-50 to-blue-300 dark:bg-[#192237] dark:bg-none overflow-hidden relative">

    <h2 class="text-3xl font-bold text-center mb-12  dark:text-white">Our Alumni are in</h2>

    <div class="marquee-container overflow-hidden whitespace-nowrap">
      <div class="marquee-content inline-flex animate-marquee">
        {% for logo in alumni_logos %}
        <img src="{% static logo.image %}" alt="{{ logo.name }}"
          class="h-16 sm:h-20 md:h-28 lg:h-32 object-contain rounded-lg mx-2" />

        {% endfor %}
        {% for logo in alumni_logos %}
        <img src="{% static logo.image %}" alt="{{ logo.name }}"
          class="h-16 sm:h-20 md:h-28 lg:h-32 object-contain rounded-lg mx-2" />

        {% endfor %}
      </div>
    </div>
  </section>


  <section class="dark:bg-slate-900 w-full overflow-hidden relative">
    <div class="max-w-full mx-auto relative">
      <div class="px-6 text-center py-5">
        <h2 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold my-10 dark:text-white leading-tight">Events
        </h2>
      </div>
      <div class="mx-10">

        <div id="carousel-track" class="flex transition-transform duration-500 ease-in-out my-8 gap-6 pr-10">
          {% for event in events %}
          <div class="flex-shrink-0 w-full lg:w-1/3 flex justify-center">
            <div
              class="carousel-card w-full max-w-md dark:bg-slate-700 rounded-lg shadow-xl overflow-hidden hover:shadow-2xl dark:hover:shadow-indigo-900 dark:hover:shadow-xl transition-all duration-300 transform hover:scale-105">

              <img src="{% static event.thumbnail %}" alt="{{ event.name }}" class="w-full h-80 object-fill">

              <div class="p-6 space-y-3">
                <h3 class="text-xl font-semibold dark:text-white mb-1">{{ event.name }}</h3>
                <p class="dark:text-slate-300 leading-relaxed text-sm">{{ event.description }}</p>

                <div class="text-sm text-slate-500 dark:text-slate-400 mt-2 flex items-center justify-between">
                  <span><strong>Start:</strong> {{ event.start_date }}</span>
                  <span><strong>End:</strong> {{ event.end_date }}</span>
                </div>
              </div>

            </div>
          </div>
          {% endfor %}
        </div>


      </div>
      <div class="flex justify-center items-center gap-8 mb-6">

        <button id="carousel-prev" aria-label="Previous slide"
          class="h-14 w-14 flex items-center justify-center bg-blue-500 dark:bg-gray-700 hover:bg-blue-600 text-white rounded-full shadow-lg hover:shadow-xl">
          <span class="text-3xl">&#8249;</span>
        </button>

        <div id="carousel-dots" class="flex justify-center space-x-3 "></div>

        <button id="carousel-next" aria-label="Next slide"
          class="h-14 w-14 flex items-center justify-center bg-blue-500 dark:bg-gray-700 hover:bg-blue-600 text-white rounded-full shadow-lg hover:shadow-xl">
          <span class="text-3xl">&#8250;</span>
        </button>
      </div>


    </div>
  </section>



  <section class="dark:bg-slate-900">
    <div class="max-w-6xl mx-auto space-y-12 px-6 pb-10">
      <div class="px-4 mb-6 text-center py-2">
        <h2 class="text-3xl mt-10 sm:text-4xl md:text-5xl lg:text-6xl font-bold  dark:text-white leading-tight">
          People that make {{ sig.name }} ❤️
        </h2>
      </div>

      <img src="{% static sig.sig_image %}" alt="{{ sig.name }}"
        class="rounded-lg mb-4 max-h-[20rem] sm:max-h-[28rem] lg:max-h-[32rem] object-contain mx-auto">

    </div>
  </section>


  <div class="px-6 text-center mt-10 py-8 ">
    <h2 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold  dark:text-white leading-tight">Societies</h2>
  </div>
  <section class="hero min-h-[30vh] min-w-screen ">

    <div class="flex flex-col lg:flex-row gap-20 justify-between mx-auto items-center">
      {% for society in societies_linked_to_sig %}
      <a href="{{ society.url }}">
        {% if society.dark_image %}
        <img src="{% static society.image %}" class="p-4 h-20 light-logo sm:h-20 lg:h-40 inline">
        <img src="{% static society.dark_image %}" class="p-4 h-20 sm:h-20 dark-logo lg:h-40 inline">

        {% else %}
        <img src="{% static society.image %}" class="p-4 h-20 sm:h-20 lg:h-40 inline">
        {% endif %}
      </a>
      {% empty %}
      {% endfor %}
    </div>
  </section>
</div>

{% endblock %}

{% block script %}

<script>

  const track = document.getElementById('carousel-track');
  const slides = track.children;
  const totalSlides = slides.length;

  let currentSlide = 0;
  let currentPage = 0;
  let autoPlayInterval;

  const dotsContainer = document.getElementById('carousel-dots');
  const prevBtn = document.getElementById('carousel-prev');
  const nextBtn = document.getElementById('carousel-next');

  function getCardsPerView() {
    if (window.innerWidth >= 1024) return 3;
    if (window.innerWidth >= 640) return 2;
    return 1;
  }

  let cardsPerView = getCardsPerView();

  window.addEventListener("resize", () => {
    cardsPerView = getCardsPerView();
    renderDots();
    updateCarousel();
  });

  function renderDots() {
    dotsContainer.innerHTML = "";

    let dotsCount;
    if (window.innerWidth >= 1024) {
      dotsCount = Math.ceil(totalSlides / cardsPerView);
    } else {
      dotsCount = totalSlides;
    }

    for (let i = 0; i < dotsCount; i++) {
      const dot = document.createElement("button");
      dot.className =
        "w-3 h-3 rounded-full bg-sky-200 dark:bg-gray-500 hover:bg-blue-500 dark:hover:bg-white transition-all duration-300";
      dot.addEventListener("click", () => {
        if (window.innerWidth >= 1024) {
          currentPage = i;
          currentSlide = i * cardsPerView;
        } else {
          currentSlide = i;
        }
        updateCarousel();
        resetAutoPlay();
      });
      dotsContainer.appendChild(dot);
    }

    if (dotsCount <= 1) {
      dotsContainer.style.display = "none";
      prevBtn.style.display = "none";
      nextBtn.style.display = "none";
    } else {
      dotsContainer.style.display = "flex";
      prevBtn.style.display = "flex";
      nextBtn.style.display = "flex";
    }
  }

  prevBtn.addEventListener('click', () => {
    if (window.innerWidth >= 1024) {
      currentPage = (currentPage - 1 + Math.ceil(totalSlides / cardsPerView)) % Math.ceil(totalSlides / cardsPerView);
      currentSlide = currentPage * cardsPerView;
    } else {
      currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
    }
    updateCarousel();
    resetAutoPlay();
  });

  nextBtn.addEventListener('click', () => {
    nextSlide();
    resetAutoPlay();
  });

  function updateCarousel() {

    const cardWidth = slides[0].offsetWidth + 24;
    const maxShift = (totalSlides - cardsPerView) * cardWidth;

    let shift = currentSlide * cardWidth;
    if (shift > maxShift) shift = maxShift;
    track.style.transform = `translateX(-${shift}px)`;

    const dots = dotsContainer.children;
    Array.from(dots).forEach((dot, idx) => {
      let activeIdx;
      if (window.innerWidth >= 1024) {
        activeIdx = currentPage;
      } else {
        activeIdx = currentSlide;
      }

      if (idx === activeIdx) {
        dot.classList.add("bg-blue-500", "dark:bg-white");
        dot.classList.remove("bg-sky-200", "dark:bg-gray-500");
      } else {
        dot.classList.add("bg-sky-200", "dark:bg-gray-500");
        dot.classList.remove("bg-blue-500", "dark:bg-white");
      }

    });
  }

  function nextSlide() {
    if (window.innerWidth >= 1024) {
      const totalPages = Math.ceil(totalSlides / cardsPerView);
      currentPage = (currentPage + 1) % totalPages;
      currentSlide = currentPage * cardsPerView;
    } else {
      currentSlide = (currentSlide + 1) % totalSlides;
    }
    updateCarousel();
  }

  function resetAutoPlay() {
    clearInterval(autoPlayInterval);
    autoPlayInterval = setInterval(nextSlide, 4000);
  }

  renderDots();
  updateCarousel();
  autoPlayInterval = setInterval(nextSlide, 4000);
</script>


<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
{% endblock %}